async function w(o){function t(){if(document.getElementById("hex-viewer-style"))return;const n=document.createElement("link");n.id="hex-viewer-style",n.rel="stylesheet",n.href="./hexViewerTool.css",document.head.appendChild(n)}t();try{const n=await fetch("hexViewerTool.html");if(!n.ok)throw new Error(`Failed to load Hex Viewer HTML: ${n.status}`);const r=await n.text();if(r.includes("<!DOCTYPE html")||r.includes("<html"))throw new Error("Invalid HTML content - contains full page structure");o.innerHTML=r,g()}catch(n){console.error("Error loading Hex Viewer:",n),o.innerHTML='<div class="error">Failed to load Hex Viewer tool</div>'}}function g(){const o=document.getElementById("hexInput"),t=document.getElementById("hexOutput"),n=document.getElementsByName("hexViewMode"),r=document.getElementById("hexCopyBtn"),f=document.getElementById("hexClearBtn"),u=document.getElementById("hexShowBtn");if(!o||!t){console.error("Hex Viewer: Missing essential DOM elements");return}function m(e){return e.toString(16).padStart(2,"0").toUpperCase()}function l(e,a){if(t){if(!e){t.innerHTML="";return}if(a==="hex"){let d="";for(const c of e){const p=new TextEncoder().encode(c),x=Array.from(p).map(m).join(" ");d+=`<span class="hexcode" data-char="${h(c)}" title="${h(c)}">${x}</span> `}t.innerHTML=d.trim()}else{let d="";for(const c of e){const p=c.codePointAt(0);d+=`<span class="codepoint" data-char="${h(c)}">U+${p.toString(16).toUpperCase().padStart(4,"0")}</span> `}t.innerHTML=d.trim()}}}function h(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function s(){var e;return((e=Array.from(n).find(a=>a.checked))==null?void 0:e.value)||"hex"}u&&u.addEventListener("click",()=>l(o.value,s())),o&&o.addEventListener("input",()=>l(o.value,s())),n&&n.length&&n.forEach(e=>{e&&e.addEventListener("change",()=>l(o.value,s()))}),u&&o&&u.addEventListener("click",()=>l(o.value,s())),t&&(t.addEventListener("mouseover",e=>{if(e.target.classList.contains("hexcode")||e.target.classList.contains("codepoint")){const a=e.target.getAttribute("data-char");v(e.target,a)}}),t.addEventListener("mouseout",e=>{(e.target.classList.contains("hexcode")||e.target.classList.contains("codepoint"))&&y()})),r&&t&&r.addEventListener("click",()=>{const e=t.textContent||"";e&&navigator.clipboard.writeText(e)}),f&&t&&o&&f.addEventListener("click",()=>{t.innerHTML="",o.value=""}),l(o.value,s())}let i;function v(o,t){i||(i=document.createElement("div"),i.className="hex-tooltip",document.body.appendChild(i)),i.textContent=t;const n=o.getBoundingClientRect();i.style.display="block",i.style.left=n.left+window.scrollX+n.width/2-12+"px",i.style.top=n.top+window.scrollY-36+"px"}function y(){i&&(i.style.display="none")}function E(o){if(!document.getElementById("hexviewer-css-link")){const t=document.createElement("link");t.id="hexviewer-css-link",t.rel="stylesheet",t.href="hexViewerTool.css",document.head.appendChild(t)}w(o)}export{E as load,w as loadHexViewerTool,g as setupHexViewerTool};
