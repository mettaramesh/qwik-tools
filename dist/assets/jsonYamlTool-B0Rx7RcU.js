function m(t){if(window.jsyaml)return t&&t(window.jsyaml);const o=document.createElement("script");o.src="/js-yaml.min.js",o.onload=()=>t&&t(window.jsyaml),o.onerror=()=>{console.error("Failed to load js-yaml.min.js"),t&&t(null)},document.head.appendChild(o)}async function y(t){try{const o=await fetch("jsonYamlTool.html");if(!o.ok)throw new Error(`Failed to load JSON-YAML tool HTML: ${o.status}`);const e=await o.text();if(console.log("JSON-YAML HTML loaded, length:",e.length,"first 100 chars:",e.substring(0,100)),e.includes("<!DOCTYPE html")||e.includes("<html"))throw new Error("Invalid HTML content - contains full page structure");t.innerHTML=e}catch(o){console.error("Error loading JSON-YAML tool:",o),t.innerHTML='<div class="error">Failed to load JSON-YAML tool</div>';return}}function w(t){try{return window.jsyaml.load(t,{schema:window.jsyaml.DEFAULT_SCHEMA,json:!0})}catch(o){throw new Error(`YAML parsing error: ${o.message}`)}}function h(t,o=!1){try{const e=JSON.parse(t);return window.jsyaml.dump(e,{indent:2,lineWidth:-1,quotingType:o?'"':null,forceQuotes:o})}catch(e){throw new Error(`JSON parsing error: ${e.message}`)}}function f(t){try{return JSON.parse(t),!0}catch{return!1}}function g(t){try{return window.jsyaml.load(t),!0}catch{return!1}}function v(){const t=document.getElementById("json-yaml-input"),o=document.getElementById("json-yaml-output"),e=document.getElementById("json-yaml-status"),s=document.getElementById("force-quotes-checkbox"),l=document.getElementById("to-yaml"),r=document.getElementById("to-json"),a=document.getElementById("json-yaml-clear-btn");function c(){return s&&s.checked}l&&t&&o&&e&&(l.onclick=()=>{try{if(!t.value.trim())throw new Error("Input is empty");if(!f(t.value))throw new Error("Invalid JSON");const n=h(t.value,c());if(!n)throw new Error("Could not convert JSON to YAML");o.value=n,e.className="success-message",e.textContent="Converted to YAML",e.classList.remove("hidden")}catch(n){o.value="",e.className="error-message",e.textContent=n.message||"Error converting to YAML",e.classList.remove("hidden")}}),r&&t&&o&&e&&(r.onclick=()=>{try{if(!t.value.trim())throw new Error("Input is empty");if(!g(t.value))throw new Error("Invalid YAML");const n=w(t.value);if(!n)throw new Error("Could not convert YAML to JSON");o.value=JSON.stringify(n,null,2),e.className="success-message",e.textContent="Converted to JSON",e.classList.remove("hidden")}catch(n){o.value="",e.className="error-message",e.textContent=n.message||"Error converting to JSON",e.classList.remove("hidden")}}),a&&t&&o&&e&&(a.onclick=()=>{t.value="",o.value="",e.classList.add("hidden")}),document.querySelectorAll(".copy-btn").forEach(n=>{n.onclick=function(){const d=n.getAttribute("data-target"),i=document.getElementById(d);i&&navigator.clipboard.writeText(i.value).then(()=>{const u=n.textContent;n.textContent="Copied!",setTimeout(()=>{n.textContent=u},1e3)})}})}async function E(t,o){return await y(t),new Promise((e,s)=>{m(l=>{if(l)v(),e();else{console.error("Failed to load js-yaml library");const r=document.getElementById("tool-content");r&&(r.innerHTML='<div class="error">Failed to load YAML library</div>'),s(new Error("Failed to load js-yaml library"))}})})}export{E as load,y as loadJSONYAMLTool};
