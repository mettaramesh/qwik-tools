async function C(i){const o=await fetch("src/numberBaseTool.html").then(m=>m.text());i.innerHTML=o,I()}async function W(i){if(!document.getElementById("numberbase-css-link")){const o=document.createElement("link");o.id="numberbase-css-link",o.rel="stylesheet",o.href="numberBaseTool.css",document.head.appendChild(o)}await C(i)}function I(){const i=e=>document.getElementById(e),o={bin:i("bin"),oct:i("oct"),dec:i("dec"),hex:i("hex"),custom:i("custom")},m={bin:i("binMsg"),oct:i("octMsg"),dec:i("decMsg"),hex:i("hexMsg"),custom:i("customMsg")},L=i("signedToggle"),E=i("groupSize"),h=i("prefixes"),u=i("customBase");for(let e=2;e<=36;e++){const t=document.createElement("option");t.value=String(e),t.textContent=`Base ${e}`,e===5&&(t.textContent+=" · quinary"),e===8&&(t.textContent+=" · octal"),e===10&&(t.textContent+=" · decimal"),e===12&&(t.textContent+=" · dozenal"),e===16&&(t.textContent+=" · hex"),u.appendChild(t)}u.value="7";const x="0123456789abcdefghijklmnopqrstuvwxyz";function N(e){return(e||"").trim().toLowerCase().replace(/[_\s]/g,"")}function S(e,t){const n=e<=10?`[0-${e-1}]`:`[0-9a-${x[e-1]}]`,c=t?"-?":"";return new RegExp(`^${c}(?:${n})+$`)}function $(e,t,n){const c=N(e);if(!c)return null;if(!S(t,n).test(c))throw new Error(`Invalid digits for base ${t}`);let a=!1,l=0;n&&c[0]==="-"&&(a=!0,l=1);let s=0n;for(;l<c.length;l++){const b=c[l],d=BigInt(x.indexOf(b));if(d<0n||d>=BigInt(t))throw new Error("Bad digit");s=s*BigInt(t)+d}return a?-s:s}function M(e,t){if(!t||t<=0)return e;e=e.replace(/\s+/g,"");let n="",c=0;for(let r=e.length-1;r>=0;r--)n=e[r]+n,c++,c%t===0&&r!==0&&(n=" "+n);return n}function B(e,t,n){if(e==null)return"";const c=e<0n;let r=c?-e:e;if(r===0n)return"0";let a="";const l=BigInt(t);for(;r>0n;){const s=r%l;a=x[Number(s)]+a,r=r/l}return a=M(a,n),c?"-"+a:a}function y(e){switch(e){case 2:return"0b";case 8:return"0o";case 16:return"0x";default:return""}}function f(e,t,n=!1){m[e].textContent=t,m[e].className=n?"ok":/Invalid|error/i.test(t)?"err":"hint"}function w(e){const t={bin:2,oct:8,dec:10,hex:16,custom:Number(u.value)};let n=o[e].value.trim();if(h.value==="std"&&n){let c="",r=n;n.startsWith("-")&&(c="-",r=n.slice(1)),r=r.replace(/\s|_/g,"");const a=y(t[e]);n=c+(a||"")+r}navigator.clipboard.writeText(n).then(()=>{f(e,"Copied to clipboard ✔",!0),setTimeout(()=>f(e,p[e]),1400)}).catch(()=>{f(e,"Clipboard error",!1)})}const p={bin:"Digits: 0–1",oct:"Digits: 0–7",dec:"Digits: 0–9",hex:"Digits: 0–9 a–z",custom:"Base 2–36"};let v=!1;function g(e){if(v)return;v=!0;const t={bin:2,oct:8,dec:10,hex:16,custom:Number(u.value)},n=Number(E.value);let c=null;try{let s=o[e].value;s=D(s,t[e]),c=$(s,t[e],L.checked),f(e,p[e])}catch(s){f(e,String(s.message||s),!1),v=!1;return}["bin","oct","dec","hex","custom"].forEach(s=>{if(s===e)return;const b=t[s];let d=B(c,b,n);d=T(d,b),o[s].value=d,f(s,p[s])});const a=t[e];let l=B(c,a,n);l=T(l,a),o[e].value=l,v=!1}function D(e,t){return e=e.trim(),t===2&&e.startsWith("0b")||t===8&&e.startsWith("0o")||t===16&&e.startsWith("0x")?e.slice(2):e}function O(e){return h.value==="std"&&(e===2||e===8||e===16)}function T(e,t){if(!e)return"";let n="",c=e;return e.startsWith("-")&&(n="-",c=e.slice(1)),O(t)?n+y(t)+c.replace(/\s|_/g,""):e}Object.keys(o).forEach(e=>{o[e]&&(o[e].addEventListener("input",()=>g(e)),o[e].addEventListener("focus",()=>m[e].className="hint"))}),document.querySelectorAll("[data-copy]").forEach(e=>{e.addEventListener("click",()=>w(e.dataset.copy))}),E&&E.addEventListener("change",()=>{const t=["dec","hex","bin","oct","custom"].find(n=>o[n]&&o[n].value.trim()!=="")||"dec";g(t)}),h&&h.addEventListener("change",()=>{const e=["custom","dec","hex","bin","oct"].find(t=>o[t]&&o[t].value.trim()!=="")||"dec";g(e)}),u&&u.addEventListener("change",()=>{const e=["custom","dec","hex","bin","oct"].find(t=>o[t]&&o[t].value.trim()!=="")||"dec";g(e),f("custom",`Digits: 0–${Number(u.value)-1} (a–${x[Number(u.value)-1]||""} for ≥ 10)`)});const k=i("clearAll");k&&k.addEventListener("click",()=>{Object.values(o).forEach(e=>{e&&(e.value="")}),Object.keys(m).forEach(e=>f(e,p[e]))}),document.addEventListener("keydown",e=>{var t;if(e.key==="Enter"&&(e.ctrlKey||e.metaKey)){const n=document.activeElement,c=(t=Object.entries(o).find(([,r])=>r===n))==null?void 0:t[0];c&&w(c)}}),o.dec&&(o.dec.value="2025"),g("dec")}const j={render:C,postLoad:I};export{j as default,W as load,C as loadNumberBaseTool,I as setupNumberBaseTool};
