function b(t){t=t.trim(),t=t.replace(/>\s*</g,"><");const r=t.split(/(<[^>]+>)/g).filter(Boolean);let l=0,o=[];for(let s=0;s<r.length;s++){const n=r[s];if(/^<[^!?][^>]*[^\/]?>\s*$/.test(n)&&s+2<r.length&&!/^<.*>/.test(r[s+1])&&/^<\//.test(r[s+2])){const f=r[s+1].replace(/</g,"&lt;").replace(/>/g,"&gt;").trim();o.push("  ".repeat(l)+n.trim()+f+r[s+2].trim()),s+=2;continue}/^<\/.+>\s*$/.test(n)?(l=Math.max(0,l-1),o.push("  ".repeat(l)+n.trim())):/^<[^!?][^>]*[^\/]?>\s*$/.test(n)?(o.push("  ".repeat(l)+n.trim()),l++):/^<.*\/?>\s*$/.test(n)?o.push("  ".repeat(l)+n.trim()):n.trim()&&o.push("  ".repeat(l)+n.trim().replace(/</g,"&lt;").replace(/>/g,"&gt;"))}return o.join(`
`)}function E(t){return t.replace(/>\s+</g,"><").replace(/\s{2,}/g," ").trim()}function d(t){try{return!new DOMParser().parseFromString(t,"application/xml").querySelector("parsererror")}catch{return!1}}function v(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}function p(t){return t.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"')}async function x(t){const l=await(await fetch("xmlFormatter.html")).text();t.innerHTML=l,typeof y=="function"&&y()}function y(){const t=document.getElementById("xml-input"),r=document.getElementById("xml-output"),l=document.getElementById("xml-format-btn"),o=document.getElementById("xml-minify-btn"),s=document.getElementById("xml-escape-btn"),n=document.getElementById("xml-unescape-btn"),f=document.getElementById("xml-validate-btn"),h=document.getElementById("xml-clear-btn"),g=document.getElementById("xml-error");function c(e){g.textContent=e,g.classList.remove("hidden")}function u(){g.textContent="",g.classList.add("hidden")}const m=()=>{const e=t.value,i=/<[^>]+>/g.test(e),a=/&lt;|&gt;/g.test(e);s&&(i?(s.removeAttribute("disabled"),s.classList.remove("btn--disabled")):(s.setAttribute("disabled","true"),s.classList.add("btn--disabled"))),n&&(a?(n.removeAttribute("disabled"),n.classList.remove("btn--disabled")):(n.setAttribute("disabled","true"),n.classList.add("btn--disabled")))};t.addEventListener("input",m),m(),l.onclick=()=>{u();try{if(!d(t.value)){c("Input is not well-formed XML.");return}r.value=b(t.value)}catch(e){c("Formatting error: "+e.message)}},o.onclick=()=>{u();try{let e=t.value,i=/&lt;|&gt;/.test(e);if(i&&(e=p(e)),!d(e)){c("Input is not well-formed XML.");return}let a=E(e);i&&(a=v(a)),r.value=a}catch(e){c("Minify error: "+e.message)}},s&&(s.onclick=()=>{u();try{let e=t.value;if(/&lt;|&gt;/.test(e)&&(e=p(e)),!d(e)){c("Input is not well-formed XML.");return}const a=v(e);r.value=a,m()}catch(e){c("Escape error: "+e.message)}}),n&&(n.onclick=()=>{u();try{let e=t.value,i=/&lt;|&gt;/.test(e),a=e;if(i){if(a=p(e),!d(a)){c("Input is not well-formed XML.");return}}else if(!d(e)){c("Input is not well-formed XML.");return}r.value=p(e),m()}catch(e){c("Unescape error: "+e.message)}}),f&&(f.onclick=()=>{u();try{let e=t.value;if(/&lt;|&gt;/.test(e)&&(e=p(e)),!e.trim()){c("Input is empty.");return}d(e)?r.value="XML is well-formed.":(r.value="",c("Input is not well-formed XML."))}catch(e){c("Validation error: "+e.message)}}),h.onclick=()=>{t.value="",r.value="",u(),m()},document.querySelectorAll(".copy-btn").forEach(e=>{e.onclick=()=>{const i=e.getAttribute("data-target"),a=document.getElementById(i);a&&navigator.clipboard.writeText(a.value).then(()=>{}).catch(L=>{})}})}export{x as load,y as setup};
