function w(){if(document.getElementById("hex-viewer-style"))return;const n=document.createElement("link");n.id="hex-viewer-style",n.rel="stylesheet",n.href="./hexViewerTool.css",document.head.appendChild(n)}async function g(n){w();try{const e=await fetch("hexViewerTool.html");if(!e.ok)throw new Error(`Failed to load Hex Viewer HTML: ${e.status}`);const o=await e.text();if(o.includes("<!DOCTYPE html")||o.includes("<html"))throw new Error("Invalid HTML content - contains full page structure");n.innerHTML=o,v()}catch(e){console.error("Error loading Hex Viewer:",e),n.innerHTML='<div class="error">Failed to load Hex Viewer tool</div>'}}function v(){const n=document.getElementById("hexInput"),e=document.getElementById("hexOutput"),o=document.getElementsByName("hexViewMode"),p=document.getElementById("hexCopyBtn"),f=document.getElementById("hexClearBtn"),d=document.getElementById("hexShowBtn");if(!n||!e){console.error("Hex Viewer: Missing essential DOM elements");return}function m(t){return t.toString(16).padStart(2,"0").toUpperCase()}function c(t,s){if(e){if(!t){e.innerHTML="";return}if(s==="hex"){let a="";for(const r of t){const h=new TextEncoder().encode(r),x=Array.from(h).map(m).join(" ");a+=`<span class="hexcode" data-char="${u(r)}" title="${u(r)}">${x}</span> `}e.innerHTML=a.trim()}else{let a="";for(const r of t){const h=r.codePointAt(0);a+=`<span class="codepoint" data-char="${u(r)}">U+${h.toString(16).toUpperCase().padStart(4,"0")}</span> `}e.innerHTML=a.trim()}}}function u(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function l(){var t;return((t=Array.from(o).find(s=>s.checked))==null?void 0:t.value)||"hex"}d&&d.addEventListener("click",()=>c(n.value,l())),n&&n.addEventListener("input",()=>c(n.value,l())),o&&o.length&&o.forEach(t=>{t&&t.addEventListener("change",()=>c(n.value,l()))}),d&&n&&d.addEventListener("click",()=>c(n.value,l())),e&&(e.addEventListener("mouseover",t=>{if(t.target.classList.contains("hexcode")||t.target.classList.contains("codepoint")){const s=t.target.getAttribute("data-char");y(t.target,s)}}),e.addEventListener("mouseout",t=>{(t.target.classList.contains("hexcode")||t.target.classList.contains("codepoint"))&&E()})),p&&e&&p.addEventListener("click",()=>{const t=e.textContent||"";t&&navigator.clipboard.writeText(t)}),f&&e&&n&&f.addEventListener("click",()=>{e.innerHTML="",n.value=""}),c(n.value,l())}let i;function y(n,e){i||(i=document.createElement("div"),i.className="hex-tooltip",document.body.appendChild(i)),i.textContent=e;const o=n.getBoundingClientRect();i.style.display="block",i.style.left=o.left+window.scrollX+o.width/2-12+"px",i.style.top=o.top+window.scrollY-36+"px"}function E(){i&&(i.style.display="none")}function L(n){if(!document.getElementById("hexviewer-css-link")){const e=document.createElement("link");e.id="hexviewer-css-link",e.rel="stylesheet",e.href="hexViewerTool.css",document.head.appendChild(e)}g(n)}export{L as load,g as loadHexViewerTool,v as setupHexViewerTool};
